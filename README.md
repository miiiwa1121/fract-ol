# fract-ol

`fract-ol`は、[MiniLibX](https://github.com/42Paris/minilibx-linux)グラフィックライブラリを使用して、美しいフラクタル図形をリアルタイムで探索できるインタラクティブなプログラムです。
このプロジェクトは、複素数平面の可視化、イベント処理、そしてグラフィックスプログラミングの基礎を学ぶことを目的としています。

## ✨ 機能

このプログラムには、以下の機能が実装されています。

  * **多彩なフラクタル**: 3種類の異なるフラクタル（マンデルブロ集合、ジュリア集合、バーニングシップ）を描画できます。
  * **無限ズーム**: マウスホイールを使って、フラクタルの細部を無限に拡大・縮小できます。
  * **マウス追従ズーム**: ズームは常にマウスカーソルの位置を中心に行われます。
  * **視点移動**: 矢印キーで表示領域を自由に移動できます。
  * **インタラクティブな色彩**: `C`キーを押すことで、サイケデリックなカラーパレットを動的に変更できます。
  * **ビューのリセット**: `R`キーでいつでも初期状態のビューに戻れます。

## Fractals

描画可能なフラクタルは以下の通りです。

1.  **Mandelbrot**: `Z = Z^2 + C` の漸化式で、`C`を変化させたときに`Z`が発散しない点の集合。
2.  **Julia**: 上記と同じ数式で、`C`を固定値とし、初期値`Z`を変化させる。`C`の値によって全く異なる模様が生まれます。
3.  **Burning Ship**: マンデルブロ集合の計算式の変形で、複素数の絶対値を取ることで、炎や船のような独特の形状を描きます。

## 🛠️ コンパイル

プロジェクトをコンパイルするには、`make`コマンドを実行してください。

```bash
make
```

これにより、`fractol`という名前の実行ファイルが生成されます。

## 🚀 使い方

以下のコマンドでプログラムを起動します。

```bash
./fractol <fractal_name> [param1] [param2]
```

### 使用例

  * **マンデルブロ集合を表示:**

    ```bash
    ./fractol mandelbrot
    ```

  * **バーニングシップを表示:**

    ```bash
    ./fractol burning_ship
    ```

  * **ジュリア集合を表示 (パラメータ指定):**
    ジュリア集合は、実部と虚部の2つのパラメータを取ります。

    ```bash
    # おすすめのパラメータ例
    ./fractol julia -0.7 0.27015
    ./fractol julia -0.8 0.156
    ```

引数が無効な場合や指定されなかった場合は、使い方が表示されます。

## 🕹️ 操作方法

| キー / マウス操作 | アクション                     |
| :---------------- | :----------------------------- |
| `マウスホイール`  | マウス位置を中心にズームイン/アウト |
| `↑` `↓` `←` `→`    | 視点の移動                     |
| `C`               | カラーパレットのシフト         |
| `R`               | 視点と色をリセット             |
| `ESC`             | プログラムを終了               |

## 📁 ディレクトリ構成

プロジェクトは、役割ごとにファイルを分離したクリーンな構成になっています。

```
.
├── Makefile
├── README.md
├── include
│   └── fractol.h
├── minilibx-linux
└── src
    ├── event_handlers.c
    ├── fractal_calculations.c
    ├── init.c
    ├── main.c
    ├── render.c
    └── utils.c
```

## 🔢 フラクタルの数学的背景

このプログラムで描画されるフラクタルは、複素数平面上での単純な漸化式の反復計算によって生まれます。ピクセルの一つ一つが複素数平面上の点に対応しており、その点が特定の計算ルールに従ったときに発散するかどうかで色が決まります。

### 1\. マンデルブロ集合 (Mandelbrot Set)

マンデルブロ集合は、以下の漸化式によって定義されます。

![alt text](image.png)

この式の各要素は以下の通りです。

  * **C**: 複素数平面上の点の座標。`render.c`でピクセルごとに計算され、この点 `C` がマンデルブロ集合に属するかどうかを判定します。
  * **Z**: 計算のたびに値が変化する複素数。初期値は常に **Z\<sub\>0\</sub\> = 0** です。

この計算を何度も繰り返したとき、`Z` の値が無限に大きくならずに、ある範囲に留まり続けるような点 `C` の集まりがマンデルブロ集合です。プログラムでは、`Z` の原点からの距離の2乗が`4.0`を超えた時点で「発散した」とみなし、その時点での繰り返し回数 `i` を返します。

### 2\. ジュリア集合 (Julia Set)

ジュリア集合は、マンデルブロ集合と全く同じ漸化式から生まれます。

![alt text](image-1.png)

しかし、`Z`と`C`の役割がマンデルブロ集合とは逆になります。

  * **Z**: 複素数平面上の点の座標。各ピクセルの位置が、計算の初期値 **Z\<sub\>0\</sub\>** となります。
  * **C**: プログラム起動時に引数として与えられる**固定の複素数**。

この定数`C`の値を少し変えるだけで、全く異なる形の美しい図形が生まれます。これが、ジュリア集合が「パラメータによって無限のバリエーションを持つ」と言われる理由です。

### 3\. バーニングシップ (Burning Ship)

バーニングシップは、マンデルブロ集合の計算式を少し変形させたものです。基本的な構造は同じですが、`Z`の2乗を計算する際に、`Z`の実部と虚部の**絶対値**を取る点が異なります。

![alt text](image-2.png)

コード上では、虚部の計算が以下のように実装されています。

`z.im = 2.0 * fabs(z.re) * fabs(z.im) + c.im;`

`fabs()`は浮動小数点数の絶対値を取る関数です。このわずかな変更により、複素数平面の対称性が崩れ、まるで炎を上げて沈んでいく帆船のような、独特で複雑な形状が生み出されます。

## 💡 コード解説

このプロジェクトは、機能ごとにソースコードがモジュール化されています。各ファイルは単一の責任を持ち、互いに連携して動作します。

### `main.c`
プログラムの**エントリーポイント**です。以下の役割を担います。
* 起動時のコマンドライン引数を検証し、表示するフラクタルの種類を決定します。
* グラフィック環境の初期化 (`fractol_init`) を呼び出します。
* イベントフックを設定 (`setup_hooks`) します。
* 最初の描画 (`fractol_render`) を行い、`mlx_loop`でイベントの待機ループを開始します。

### `include/fractol.h`
プロジェクト全体の**設計図**となるヘッダファイルです。
* `t_fractol`構造体を定義し、プログラムの状態（ズーム率、オフセット、色など）を管理します。
* キーコードやウィンドウサイズなどの定数を定義します。
* プロジェクト全体で使用される関数のプロトタイプ宣言をまとめ、異なるファイル間の連携を可能にします。

### `src/init.c`
**初期化処理**を専門に行うファイルです。
* MiniLibXライブラリを初期化し、ウィンドウと描画用のイメージを作成します。
* `t_fractol`構造体の各変数をデフォルト値に設定します。

### `src/fractal_calculations.c`
フラクタルの**数学的な計算**の心臓部です。
* `mandelbrot`、`julia`、`burning_ship`といった各種フラクタルの漸化式を計算します。
* 複素数平面上の特定の点について、計算が発散するまでの繰り返し回数を返します。

### `src/render.c`
**描画処理**を担当します。
* ウィンドウのすべてのピクセルをスキャンし、各ピクセルに対応する複素数を計算します。
* `fractal_calculations.c`の関数を呼び出して得られた繰り返し回数に基づき、ピクセルの色を決定します。
* 最終的なイメージをウィンドウに表示します。

### `src/event_handlers.c`
キーボードやマウスからの**ユーザー入力**を処理します。
* `mlx_hook`によって登録され、イベント発生時に呼び出されます。
* キー入力（移動、色変更、リセット、終了）やマウスホイール（ズーム）に応じて`t_fractol`構造体の状態を更新し、再描画をトリガーします。

### `src/utils.c`
複数の場所から利用される**補助的な便利関数**をまとめたファイルです。
* 文字列から数値への変換 (`ft_atof`) や文字列比較 (`ft_strcmp`)。
* ピクセルをイメージに描画する低レベルな関数 (`put_pixel`)。
* エラー処理や使用方法の表示など。